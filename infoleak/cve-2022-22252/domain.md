## Huawei zrhung diagnostic IOCTLs (Domain)

Huawei’s customized Linux kernels include a diagnostic subsystem called **zrhung**, used for detecting and logging hung processes.  
It exposes configuration and status interfaces through `/dev/hcfgk` IOCTL handlers like `hcfgk_set_cfg()` (setter) and `hcfgk_ioctl_get_cfg()` (getter).  
Internally, a global context (`ctx`) holds dynamically allocated tables and pointers that define logging parameters.  
Since IOCTLs can be called from multiple threads concurrently, Huawei’s implementation uses spinlocks for synchronization — but mishandling memory swaps or unlock ordering can still create UAF and info-leak conditions between these “set” and “get” calls.

