## VirtualBox VBVA Shared Memory Interface (Domain)

VirtualBox exposes a shared-memory region between the host and guest for **VirtualBox Video Acceleration (VBVA)** — essentially a fast path for graphics updates.  
This is memory-mapped inside the guest at a fixed physical address (`0xE0000000`), and commands written there by the guest kernel driver are consumed by host-side C++ objects in the VirtualBox process.

Inside the host, each command (create surface, blit, flip, overlay update, etc.) is translated into operations on objects like `VBoxVHWASurfaceBase` and `VBoxVHWADisplay`.  
These surfaces are tracked in a **handle table** (`mSurfHandleTable`) mapping guest-supplied integer handles to host pointers. The guest can later reference or destroy these surfaces by handle — meaning the guest indirectly controls what host pointers get used, making this a high-value attack surface.

The VBVA command executor (`vboxDoVHWACmdExec`) runs in the VirtualBox host process and directly uses data supplied by the guest, so a bug here (especially in object lifecycle or table management) can lead to memory corruption or **VM escape**.

