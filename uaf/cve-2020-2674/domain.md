## VirtualBox OHCI USB Host Controller (Domain)

VirtualBox runs as a type-2 (hosted) hypervisor — a userspace process on the host OS that emulates hardware devices for guest VMs.  
One of those devices is an **OHCI** (Open Host Controller Interface) USB controller, implemented entirely in userspace.

The guest kernel loads its normal USB host controller driver, unaware it’s virtualized. Every USB packet it sends (TD/ED descriptors) is handled by VirtualBox’s emulated OHCI, which allocates **URBs (USB Request Blocks)** on the host side and routes data to virtual or passthrough USB devices.

Because guest code is untrusted, this layer is a critical isolation boundary:  
malformed descriptors, incorrect reference counts, or logic bugs in the URB lifecycle (allocation, submission, freeing) can let guest input corrupt host memory or trigger use-after-free bugs inside the VirtualBox process — resulting in **VM escape**.

