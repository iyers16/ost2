# 2022-CVE-None-MSMu

## Domain knowledge

project mu: microsoft’s open-source hardened fork of EDK2 used for UEFI firmware on devices like Surface. it adds security wrappers (like “SMM supervisor”) to run system-management-mode code with a userspace/kernelspace split.

smm: special privileged cpu mode (system management mode) used for power and firmware tasks. runs in isolated smram and can normally touch all memory, so bugs here are critical. new intel designs and project mu’s “SMM Supervisor” add privilege separation so smm “user” code must make syscalls to the smm “kernel.”

syscalls: in mu’s smm, user-mode smi handlers talk to kernel via system calls (e.g. `SMM_MM_HDL_UNREG_1`, `SMM_MM_HDL_UNREG_2`). parameters include pointers to handler code, GUIDs, and context buffers — all attacker-controlled if SMM user is compromised.

race surface: kernel dereferences those user pointers multiple times across syscalls and functions without copying them into local memory, creating TOCTOU races and double-fetch windows inside firmware.

