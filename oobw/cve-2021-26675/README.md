# CVE-2021-26675

I wanted to take a bit of a reverse approach here.

Let me start by looking into the memcpy found at the bottom.

We're trying to copy 63 bytes from ptr into uptr.

I don't totally understand why we went through trying to allocate things up above in uptr if we're just squashing it with the memcpy so let me parse the strncpy instead.

There we are attempting to write a 63-byte label string into uptr, however the length seems a bit too composite to be true.

At first glance we can see that in this strncpy both the destination buffer and the size calculation are both ACID-affected, so this is already an indication that we're on the right path.

So what is the vulnerability really about here? Or what exactly can we exploit here?

So it doesnt look like uptr or uncompressed are being sanity checked for their values/sizes, so that size calculation at the end of strncpy can definitely be taken advantage of in order to copy somethings stuffed in or after name to insert into uptr. The fact that even after that uptr goes without sanity checks into a memcpy just seems destructive as well.
