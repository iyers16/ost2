#include <string.h>

#define EFI_NOT_FOUND 1

int CONVERT_HEX(char c) { return 0; }

int idx;
unsigned char *write_ptr;
unsigned char buf_on_stack[0x158];
unsigned char calculated_sha256[32];
int retval;
const char *hex_ptr;

void snippet(void) {
    idx = 0;
    write_ptr = buf_on_stack; //rbp-0x158
    while(1) {
        if ( idx >= strnlen(hex_ptr, sizeof(buf_on_stack) * 2) ) // fixed to stop at the end of the buffer limit
            break;

        *write_ptr++ = CONVERT_HEX(hex_ptr[idx]) << 4 |
                       CONVERT_HEX(hex_ptr[idx+1]);
        idx += 2;
    }
    if ( buf_on_stack != calculated_sha256 ) {
        if ( memcmp(buf_on_stack, calculated_sha256, 32) )
            retval = EFI_NOT_FOUND;
    }
}
