# CVE-Unknown-SSBB-BH2021ðŸ‡°ðŸ‡·

This seems to be a much more cryptic code snippet than the others before, however a quick scan shows a `memcpy()` being performed in `IMSPL_XmlGetNextTagName`. That's going to be my starting point.

The ACID input seems to be the `char *src` field in this function.

We first parse to find the end of the tag, in which case the tag name is stored in result which is `v13`. This is then checked not to be the same as the char under `v8` meaning the opening bracket. But then without bound checking the size of `v13` against the size of `dst`, we are performing a `memcpy`. 

This means that if an actor abuses a tag name in the xml, padding it enough to squash the stack and overwrite `rbp` and/or the return pointer then they would be able to affect the program by insert all kinds of ROP gadgets.


I found it interesting to note that in `find_tag_end` there are ACID exit conditions that keep parsing until some condition is reached (specific ascii chars). 
If this were paired with some memory writing operations, then it would be extremely dangerous - however in our case there's nothing of the sort, it just exits elegantly and moves on so that wasn't the focus of my analysis today.